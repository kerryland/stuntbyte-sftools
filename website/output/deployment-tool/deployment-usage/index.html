<!DOCTYPE HTML>
<html lang="en">

  <meta name="robots" content="index, follow" />

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-28301451-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

  <head>
    <meta charset="utf-8">
    <meta name="keywords" content="sfdc, salesforce, apex code, triggers, jdbc, ide, deployment" />
    <title>Stuntbyte - Deployment Tool Usage</title>
    <link rel="stylesheet" type="text/css" href="/style.css" media="screen">
    <meta name="generator" content="nanoc 3.3.7">
  </head>
  <body>
    <div id="main">
    <h1>Deployment Tool Usage</h1>
      <p>Here's how to make use of the deployment tool</p>
<h2>Step 1. Install it.</h2>
<p>Currently the deployment tool is embedded within the JDBC driver. You have to <a href="/jdbc-driver/jdbc-configuration">install that first</a>. We've added some new commands to the JDBC driver.</p>
<h2>Step 2. Write a script to create a deployment file</h2>
<p>There are only a few commands. Here's an example script that illustrates most of them:</p>
<pre><code class="language-sql"><table class="CodeRay"><tr>
<td class="line-numbers" title="double click to toggle" ondblclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
<a href="#n7" name="n7">7</a>
<a href="#n8" name="n8">8</a>
</pre></td>
  <td class="code"><pre>dep start;
dep <span class="class">add</span> ApexClass UpgradeController;
dep <span class="class">add</span> ApexClass UpgradeControllerTest;
dep <span class="class">add</span> CustomObject UpgradeOptions__c;
dep <span class="class">add</span> CustomField Account.UpgradeOption__c;
dep <span class="class">drop</span> ApexPage SomeObsoletePage;
dep <span class="class">commit</span>;
dep package <span class="keyword">to</span> <span class="string"><span class="delimiter">'</span><span class="content">c:/tmp/my-deployment.zip</span><span class="delimiter">'</span></span>;</pre></td>
</tr></table></code></pre>
<ul>
<li>"add" commands represent objects you want to add or update.</li>
<li>"drop" commands represent objects you want to remove from the destination instance.</li>
<li>The parameters represent the type of component being deployed, and the component itself, that you want to move to, or remove from, the target instance.</li>
<li>"start" and "commit" define the start end end of the objects to deploy</li>
<li>"package" downloads the components and assembles them into a zip file.</li>
</ul><p>Now connect to the salesforce instance that contains these components, and run the script. Upon completion you will have a zip file containing the items defined in the script.</p>
<h2>Step 3: Deploy the deployment file</h2>
<p>You can now connect the JDBC driver to the instance of salesforce that you want to deploy the package to, and run the following command, pointing it at the "zip" file you defined when you originally created the package:</p>
<pre><code class="language-sql"><table class="CodeRay"><tr>
<td class="line-numbers" title="double click to toggle" ondblclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }"><pre>
</pre></td>
  <td class="code"><pre>dep upload package <span class="keyword">from</span> <span class="string"><span class="delimiter">'</span><span class="content">c:/tmp/my-deployment.zip</span><span class="delimiter">'</span></span> <span class="keyword">to</span> <span class="string"><span class="delimiter">'</span><span class="content">c:/tmp/deploy.log</span><span class="delimiter">'</span></span>;</pre></td>
</tr></table></code></pre>
<p>The log file is where deployment logs are written, which can be useful when tracking down the deployment problems that are so common with Salesforce deployments -- no matter what tool you use.</p>
<p>Monitor the deployment by examining the log file you defined, or from within Salesforce by viewing the Setup | Deployment | Monitor Deployments page.</p>
<p>The deploy "upload" command actually takes an optional parameter, not shown above, that can be placed before the "from" keyword. It has the following values</p>
<table><tbody>
<tr>
<th>Parameter</th>
<th>Meaning</th>
</tr>
<tr>
<td>checkonly</td>
<td>Don't actually do a deployment, just check to see if it would work</td>
</tr>
<tr>
<td>alltests</td>
<td>Run all tests in the target environment</td>
</tr>
<tr>
<td>runtests</td>
<td>Only run the tests that you are currently deploying. This option is not available when deploying to a production environment</td>
</tr>
<tr>
<td>ignore_errors</td>
<td>Attempt to deploy, even though Salesforce may report errors</td>
</tr>
<tr>
<td>ignore_warnings</td>
<td>Attempt to deploy, even though Salesforce may report warnings</td>
</tr>
<tr>
<td>status &lt;jobid&gt;</td>
<td>If the Salesforce network connection fails for some reason you can reconnect, resume logging, and see the final status by using STATUS option and the jobid shown at the top of the log file.</td>
</tr>
</tbody></table>
eg:<br><pre><code class="language-sql"><table class="CodeRay"><tr>
<td class="line-numbers" title="double click to toggle" ondblclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }"><pre>
</pre></td>
  <td class="code"><pre>dep upload package checkonly <span class="keyword">from</span> <span class="string"><span class="delimiter">'</span><span class="content">c:/tmp/my-deployment.zip</span><span class="delimiter">'</span></span> <span class="keyword">to</span> <span class="string"><span class="delimiter">'</span><span class="content">c:/tmp/deploy.log</span><span class="delimiter">'</span></span>;</pre></td>
</tr></table></code></pre>

<p>The zip file generated by the deployment tool can also be deployed using the Salesforce "ant" tool if you prefer.</p>
<p>If you need to "tweak" the code prior to deployment, you can edit the zip file using something like <a href="http://www.ghisler.com/">Total Commander</a>,Â or unzip, edit, and rezip file, or you can explore the "patch" commands, as described in the next section.</p>

<h1>Patching (Advanced Feature)</h1>
<p>Salesforce development can sometimes force the use of hard-coded values, such as object ids, in places like Workflow. These object ids will need to be different in every environment you deploy to, and relying on humans to remember to manually change such values is tedious and unreliable. Stuntbyte's "patching" facility gives you a clean way to handle this issue.</p>
<h2>Patch Definition</h2>
<p>In the code below we define some "patch variables" that represent the values that are required in various deployment environments. eg: what a "special user" id in dev, uat and prod. These names are completely arbitrary.</p>

<pre><code class="language-sql"><table class="CodeRay"><tr>
<td class="line-numbers" title="double click to toggle" ondblclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
<a href="#n7" name="n7">7</a>
<a href="#n8" name="n8">8</a>
<a href="#n9" name="n9">9</a>
<strong><a href="#n10" name="n10">10</a></strong>
<a href="#n11" name="n11">11</a>
<a href="#n12" name="n12">12</a>
<a href="#n13" name="n13">13</a>
<a href="#n14" name="n14">14</a>
<a href="#n15" name="n15">15</a>
<a href="#n16" name="n16">16</a>
<a href="#n17" name="n17">17</a>
<a href="#n18" name="n18">18</a>
<a href="#n19" name="n19">19</a>
<strong><a href="#n20" name="n20">20</a></strong>
<a href="#n21" name="n21">21</a>
<a href="#n22" name="n22">22</a>
<a href="#n23" name="n23">23</a>
<a href="#n24" name="n24">24</a>
<a href="#n25" name="n25">25</a>
</pre></td>
  <td class="code"><pre>dep start;
<span class="comment">-- Define "special_user" in each environment</span>
dep patch var dev.special_user=<span class="octal">00</span><span class="integer">590000000</span>dQVo;
dep patch var uat.special_user=<span class="octal">00</span><span class="integer">590000000</span>bWXy;
dep patch var prod.special_user=<span class="octal">00</span><span class="integer">590000000</span>kPBa;
 
<span class="comment">-- Define the objects that should have the "special_user" replacement</span>
<span class="comment">-- applied to them.</span>
<span class="comment">-- Note that this example is illustrating the available options, and the</span>
<span class="comment">-- use of "*" will over-ride any more granular replacement rules! </span>
dep patch rule <span class="class">replace</span> special_user <span class="keyword">in</span> ApexClass LoginChecker;
dep patch rule <span class="class">replace</span> special_user <span class="keyword">in</span> CustomField AnObject__c.AColumn__c;
dep patch rule <span class="class">replace</span> special_user <span class="keyword">in</span> *;
<span class="comment">-- The definitions above are static. From here down the script varies</span>
<span class="comment">-- according to your individual deployment</span>
 
<span class="comment">-- Indicate where you are deploying from, and to:</span>
dep patch apply <span class="keyword">from</span> dev <span class="keyword">to</span> uat;

<span class="comment">-- Continue with a normal deployment script</span>
dep <span class="class">add</span> ...
dep <span class="class">add</span> ...
dep <span class="class">commit</span>
dep package...
dep upload...</pre></td>
</tr></table></code></pre>
<p></p>
<h1>FAQ</h1>
<h2>How do I know what types of components can be deployed?</h2>
<p>The types of components supported are defined <a href="http://www.salesforce.com/us/developer/docs/api_meta/Content/file_based.htm#component_folders_title">here</a> and <a href="http://www.salesforce.com/us/developer/docs/dev_lifecycle/Content/plan_proj_meta_components.htm">here</a> (except that these pages incorrectly state 'CustomLabels' is a component type -- actually it's singular, 'CustomLabel' -- yes, we have reported the problem).</p>
<p>You can also use your SQL tool to browse the "deployment" schema.</p>

<h2>How do I know what names to use with the deployment?</h2>
<p>These are generally the "developer name" used when the object was created, but the guaranteed way to figure it out is by accessing the "deployable" table that exists for each type. eg:</p>
<pre><code class="language-sql"><table class="CodeRay"><tr>
<td class="line-numbers" title="double click to toggle" ondblclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }"><pre>
</pre></td>
  <td class="code"><pre><span class="class">SELECT</span> Identifier <span class="keyword">from</span> deployable.CustomTab</pre></td>
</tr></table></code></pre>
<p>NOTE: The "deployable" schema tables are internal to the JDBC driver and don't make use of the Salesforce query engine, consequently the only supported WHERE clause is "WHERE Identifier LIKE", and the LIKE expression isn't exhaustive :-)</p>
<br/>
    </div>
    <div id="sidebar">
      <h2>Main</h2>
      <ul>
        <li><a href="/">Home</a></li>
        <li><a href="/download">Download</a></li>
        <li><a href="/contact">Contact</a></li>
        <li><a href="/community">Community</a></li>
      </ul>
      <h2>JDBC Driver</h2>
      <ul>
        <li><a href="/jdbc-driver">Introduction</a></li>
        <li><a href="/jdbc-driver/jdbc-configuration">Configuration</a></li>
        <li><a href="/jdbc-driver/jdbc-sql-syntax">SELECT, UPDATE etc</a></li>
        <li><a href="/jdbc-driver/jdbc-sql-ddl-syntax">CREATE TABLE etc</a></li>
        <li><a href="/jdbc-driver/grant-permissions">GRANT Permissions</a></li>
        <li><a href="/jdbc-driver/limitations">Limitations</a></li>
      </ul>
      <h2>Deployment Tool</h2>
      <ul>
        <li><a href="/deployment-tool">Introduction</a></li>
        <li><a href="/deployment-tool/deployment-usage">Usage</a></li>
      </ul>
      <h2>Text Editor/IDE</h2>
      <ul>
        <li><a href="/ide">Introduction</a></li>
        <li><a href="/ide/ide-sublime-text-2">Sublime Text 2</a></li>
        <li><a href="/ide/ide-vim">VIM</a></li>
        <li><a href="/ide/ide-command-line">Command Line</a></li>
      </ul>
      <br/>
      <br/>
      &copy; <a href="/contact">stuntbyte</a> 2012
      </p> 
    </div>
  </body>
   
</html>
